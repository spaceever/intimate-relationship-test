<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº²å¯†å…³ç³»æµ‹è¯• - äº§å“åŸå‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .prototype-nav {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .prototype-nav h3 {
            font-size: 14px;
            margin-bottom: 10px;
            color: #666;
        }

        .prototype-nav a {
            display: block;
            padding: 5px 10px;
            margin: 5px 0;
            text-decoration: none;
            color: #007bff;
            font-size: 12px;
            border-radius: 4px;
        }

        .prototype-nav a:hover {
            background: #f0f0f0;
        }

        .page {
            display: none;
            max-width: 414px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            position: relative;
        }

        .page.active {
            display: block;
        }

        /* é¦–é¡µæ ·å¼ */
        .home-page {
            padding: 60px 30px;
            text-align: center;
        }

        .logo {
            font-size: 32px;
            font-weight: bold;
            color: #6366f1;
            margin-bottom: 20px;
        }

        .home-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #1f2937;
        }

        .home-subtitle {
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 40px;
            line-height: 1.8;
        }

        .btn-primary {
            display: inline-block;
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            display: inline-block;
            padding: 10px 20px;
            color: #6b7280;
            text-decoration: none;
            font-size: 14px;
        }

        /* è¯´æ˜é¡µæ ·å¼ */
        .info-page {
            padding: 40px 30px;
        }

        .page-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 30px;
            color: #1f2937;
        }

        .info-item {
            margin-bottom: 25px;
            padding-left: 25px;
            position: relative;
        }

        .info-item::before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: #667eea;
            font-size: 24px;
            line-height: 1;
        }

        .info-item h4 {
            font-size: 16px;
            margin-bottom: 8px;
            color: #374151;
        }

        .info-item p {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
        }

        .checkbox-group {
            display: flex;
            align-items: flex-start;
            margin: 30px 0;
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
        }

        .checkbox-group input {
            margin-right: 10px;
            margin-top: 2px;
        }

        .checkbox-group label {
            font-size: 14px;
            color: #374151;
        }

        /* æµ‹è¯„é¡µæ ·å¼ */
        .test-page {
            padding: 20px 30px 40px;
        }

        .progress-bar {
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 3px;
            transition: width 0.3s;
        }

        .progress-text {
            text-align: center;
            font-size: 14px;
            color: #6b7280;
            margin-bottom: 30px;
        }

        .question-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 30px 20px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .question-text {
            font-size: 18px;
            font-weight: 500;
            color: #1f2937;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .likert-scale {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .scale-label {
            font-size: 12px;
            color: #6b7280;
        }

        .scale-options {
            display: flex;
            justify-content: space-between;
            gap: 8px;
            margin: 20px 0;
        }

        .scale-option {
            flex: 1;
            padding: 12px 8px;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            color: #374151;
            transition: all 0.2s;
        }

        .scale-option:hover {
            background: #f3f4f6;
            border-color: #667eea;
        }

        .scale-option.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-outline {
            flex: 1;
            padding: 14px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            color: #374151;
            font-size: 15px;
            cursor: pointer;
        }

        .btn-submit {
            flex: 1;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 15px;
            font-weight: 500;
            cursor: pointer;
        }

        /* åŠ è½½é¡µæ ·å¼ */
        .loading-page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 40px;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 30px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 16px;
            color: #6b7280;
        }

        /* ç»“æœé¡µæ ·å¼ */
        .result-page {
            padding: 30px;
        }

        .result-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .result-badge {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #f59e0b 0%, #ef4444 100%);
            color: white;
            border-radius: 20px;
            font-size: 18px;
        }

        .result-badge.safe {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .result-badge.avoidant {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .result-subtitle {
            margin-top: 15px;
            font-size: 14px;
            color: #6b7280;
        }

        .result-chart {
            margin: 30px 0;
            padding: 20px;
            background: #f9fafb;
            border-radius: 12px;
        }

        .chart-bar {
            margin-bottom: 20px;
        }

        .chart-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            color: #374151;
        }

        .chart-fill {
            height: 12px;
            background: #e5e7eb;
            border-radius: 6px;
            overflow: hidden;
        }

        .chart-value {
            height: 100%;
            border-radius: 6px;
            transition: width 0.5s;
        }

        .chart-value.anxious {
            background: linear-gradient(90deg, #f59e0b 0%, #ef4444 100%);
        }

        .chart-value.avoidant {
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
        }

        .chart-value.safe {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
        }

        .result-section {
            margin: 30px 0;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #1f2937;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: "";
            width: 4px;
            height: 18px;
            background: #667eea;
            margin-right: 10px;
            border-radius: 2px;
        }

        .feature-list, .suggestion-list {
            list-style: none;
        }

        .feature-list li, .suggestion-list li {
            padding: 12px 15px;
            margin-bottom: 10px;
            background: #f9fafb;
            border-left: 3px solid #667eea;
            border-radius: 6px;
            font-size: 14px;
            color: #374151;
            line-height: 1.6;
        }

        .action-buttons {
            margin-top: 40px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .btn-action {
            padding: 14px;
            border-radius: 10px;
            text-align: center;
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
        }

        .btn-action.primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-action.secondary {
            background: white;
            border: 2px solid #e5e7eb;
            color: #374151;
        }

        /* åˆ†äº«é¡µæ ·å¼ */
        .share-page {
            padding: 40px 30px;
            text-align: center;
        }

        .share-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 40px 30px;
            color: white;
            margin-bottom: 30px;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
        }

        .share-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .share-subtitle {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 30px;
        }

        .qr-code-placeholder {
            width: 150px;
            height: 150px;
            background: white;
            border-radius: 12px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #667eea;
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªèœå• -->
    <div class="prototype-nav">
        <h3>åŸå‹å¯¼èˆª</h3>
        <a href="#" onclick="showPage('home'); return false;">1. é¦–é¡µ</a>
        <a href="#" onclick="showPage('info'); return false;">2. è¯´æ˜é¡µ</a>
        <a href="#" onclick="showPage('test'); return false;">3. æµ‹è¯„é¡µ</a>
        <a href="#" onclick="showPage('loading'); return false;">4. åŠ è½½é¡µ</a>
        <a href="#" onclick="showPage('result'); return false;">5. ç»“æœé¡µ</a>
        <a href="#" onclick="showPage('share'); return false;">6. åˆ†äº«é¡µ</a>
    </div>

    <!-- 1. é¦–é¡µ -->
    <div id="home" class="page active">
        <div class="home-page">
            <div class="logo">ğŸ’‘</div>
            <h1 class="home-title">äº†è§£ä½ çš„äº²å¯†å…³ç³»æ¨¡å¼</h1>
            <p class="home-subtitle">
                åŸºäºä¾æ‹ç±»å‹ç†è®º<br>
                æ¢ç´¢ä½ çš„æƒ…æ„Ÿä¾èµ–æ¨¡å¼<br>
                å‘ç°ç„¦è™‘å‹ã€å®‰å…¨å‹æˆ–å›é¿å‹çš„è‡ªå·±
            </p>
            <a href="#" class="btn-primary" onclick="showPage('info'); return false;">å¼€å§‹æµ‹è¯•</a>
            <div>
                <a href="#" class="btn-secondary">äº†è§£æµ‹è¯„ä¾æ®</a>
                <span style="margin: 0 10px;">|</span>
                <a href="#" class="btn-secondary">éšç§å£°æ˜</a>
            </div>
        </div>
    </div>

    <!-- 2. è¯´æ˜é¡µ -->
    <div id="info" class="page">
        <div class="info-page">
            <h2 class="page-title">æµ‹è¯„è¯´æ˜</h2>
            <div class="info-item">
                <h4>æµ‹è¯„æ—¶é—´</h4>
                <p>çº¦5åˆ†é’Ÿå®Œæˆï¼Œå…±15é¢˜</p>
            </div>
            <div class="info-item">
                <h4>æµ‹è¯„æ–¹å¼</h4>
                <p>æ ¹æ®ä½ çš„çœŸå®æ„Ÿå—é€‰æ‹©"å®Œå…¨ä¸åŒæ„"åˆ°"å®Œå…¨åŒæ„"ï¼Œæ²¡æœ‰æ ‡å‡†ç­”æ¡ˆ</p>
            </div>
            <div class="info-item">
                <h4>ç»“æœè¯´æ˜</h4>
                <p>ç³»ç»Ÿä¼šæ ¹æ®ä½ çš„å›ç­”ï¼Œåˆ¤æ–­ä½ åœ¨äº²å¯†å…³ç³»ä¸­çš„ä¾èµ–ç±»å‹ï¼šç„¦è™‘å‹ã€å®‰å…¨å‹æˆ–å›é¿å‹</p>
            </div>
            <div class="info-item">
                <h4>éšç§ä¿æŠ¤</h4>
                <p>ä½ çš„æ•°æ®ä»…ç”¨äºç”Ÿæˆæµ‹è¯•ç»“æœï¼Œæˆ‘ä»¬ä¸ä¼šæ”¶é›†ä¸ªäººä¿¡æ¯ç”¨äºå…¶ä»–ç”¨é€”</p>
            </div>
            <div class="checkbox-group">
                <input type="checkbox" id="agree">
                <label for="agree">æˆ‘å·²é˜…è¯»å¹¶åŒæ„éšç§å£°æ˜</label>
            </div>
            <a href="#" class="btn-primary" onclick="startTest(); return false;">å¼€å§‹æµ‹è¯„</a>
        </div>
    </div>

    <!-- 3. æµ‹è¯„é¡µ -->
    <div id="test" class="page">
        <div class="test-page">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">1 / 15</div>
            
            <div class="question-card">
                <div class="question-text" id="questionText">
                    åŠ è½½é¢˜ç›®ä¸­...
                </div>
                
                <div class="likert-scale">
                    <span class="scale-label">å®Œå…¨ä¸åŒæ„</span>
                    <span class="scale-label">å®Œå…¨åŒæ„</span>
                </div>
                
                <div class="scale-options" id="scaleOptions">
                    <div class="scale-option" data-value="1">1</div>
                    <div class="scale-option" data-value="2">2</div>
                    <div class="scale-option" data-value="3">3</div>
                    <div class="scale-option" data-value="4">4</div>
                    <div class="scale-option" data-value="5">5</div>
                </div>
            </div>
            
            <div class="nav-buttons">
                <button class="btn-outline" id="prevBtn" onclick="goToPrevQuestion()">ä¸Šä¸€é¢˜</button>
                <button class="btn-submit" id="nextBtn" onclick="goToNextQuestion()">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>
    </div>

    <!-- 4. åŠ è½½é¡µ -->
    <div id="loading" class="page">
        <div class="loading-page">
            <div class="spinner"></div>
            <p class="loading-text">æ­£åœ¨åˆ†æä½ çš„å›ç­”...</p>
        </div>
    </div>

    <!-- 5. ç»“æœé¡µ - åŠ¨æ€ç”Ÿæˆ -->
    <div id="result" class="page">
        <div class="result-page">
            <div class="result-header">
                <div class="result-badge" id="resultBadge">åˆ†æä¸­...</div>
                <p class="result-subtitle">ä½ çš„ä¸»å¯¼äº²å¯†å…³ç³»æ¨¡å¼</p>
            </div>
            
            <div class="result-chart" id="resultChart">
                <!-- åŠ¨æ€ç”Ÿæˆå›¾è¡¨ -->
            </div>
            
            <div class="result-section">
                <h3 class="section-title">ä½ çš„ç‰¹ç‚¹</h3>
                <ul class="feature-list" id="featureList">
                    <!-- åŠ¨æ€ç”Ÿæˆç‰¹ç‚¹ -->
                </ul>
            </div>
            
            <div class="result-section">
                <h3 class="section-title">ç»™ä½ çš„å»ºè®®</h3>
                <ul class="suggestion-list" id="suggestionList">
                    <!-- åŠ¨æ€ç”Ÿæˆå»ºè®® -->
                </ul>
            </div>
            
            <div class="action-buttons">
                <a href="#" class="btn-action primary" onclick="resetTest(); return false;">é‡æ–°æµ‹è¯•</a>
                <a href="#" class="btn-action secondary" onclick="shareResult(); return false;">åˆ†äº«ç»“æœ</a>
            </div>
        </div>
    </div>

    <!-- 8. åˆ†äº«é¡µ -->
    <div id="share" class="page">
        <div class="share-page">
            <h2 class="page-title" style="text-align: left; margin-bottom: 30px;">åˆ†äº«ä½ çš„ç»“æœ</h2>
            
            <div class="share-card" id="shareCard">
                <div class="share-title" id="shareTitle">æˆ‘æ˜¯ã€Œåˆ†æä¸­...ã€</div>
                <div class="share-subtitle" id="shareSubtitle">æ­£åœ¨åŠ è½½...</div>
                <div class="qr-code-placeholder">
                    [äºŒç»´ç åŒºåŸŸ]<br>
                    æ‰«ç æµ‹ä¸€æµ‹
                </div>
            </div>
            
            <div class="action-buttons">
                <a href="#" class="btn-action secondary" onclick="copyLink(); return false;">å¤åˆ¶é“¾æ¥</a>
                <a href="#" class="btn-action secondary" onclick="showPage('result'); return false;">è¿”å›ç»“æœ</a>
            </div>
        </div>
    </div>

    <script>
        // ==================== é¢˜åº“æ•°æ® ====================
        const questions = [
            // ç„¦è™‘ç»´åº¦ (A1-A5)
            { id: 1, text: "å½“ä¼´ä¾£æ²¡æœ‰åŠæ—¶å›å¤æˆ‘çš„æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä¼šå˜å¾—ç„¦è™‘ã€‚", dimension: 'anxious', reverse: false },
            { id: 2, text: "æˆ‘ç»å¸¸æ‹…å¿ƒæˆ‘ä»¬çš„å…³ç³»ä¼šçªç„¶ç»“æŸã€‚", dimension: 'anxious', reverse: false },
            { id: 3, text: "æˆ‘éœ€è¦é¢‘ç¹ç¡®è®¤ä¼´ä¾£æ˜¯å¦åœ¨ä¹æˆ‘ã€‚", dimension: 'anxious', reverse: false },
            { id: 4, text: "å½“æˆ‘ä»¬å‘ç”Ÿäº‰æ‰§åï¼Œæˆ‘å¾ˆéš¾å¹³é™ä¸‹æ¥ã€‚", dimension: 'anxious', reverse: false },
            { id: 5, text: "å½“ä¼´ä¾£æƒ³è¦ç‹¬å¤„æ—¶ï¼Œæˆ‘ä¼šæ„Ÿåˆ°è¢«æ‹’ç»ã€‚", dimension: 'anxious', reverse: false },
            
            // å›é¿ç»´åº¦ (V1-V5)
            { id: 6, text: "æˆ‘æ›´ä¹ æƒ¯è‡ªå·±å¤„ç†é—®é¢˜ï¼Œä¸å¤ªæ„¿æ„æ±‚åŠ©ä¼´ä¾£ã€‚", dimension: 'avoidant', reverse: false },
            { id: 7, text: "äº²å¯†çš„å…³ç³»è®©æˆ‘æ„Ÿåˆ°è„†å¼±ï¼Œæˆ‘å€¾å‘äºä¿æŒè·ç¦»ã€‚", dimension: 'avoidant', reverse: false },
            { id: 8, text: "æˆ‘ä¸å¤ªå–œæ¬¢è°ˆè®ºè‡ªå·±çš„æƒ…ç»ªæˆ–å†…å¿ƒéœ€æ±‚ã€‚", dimension: 'avoidant', reverse: false },
            { id: 9, text: "å½“ä¼´ä¾£éœ€è¦æˆ‘çš„æ”¯æŒå’Œå®‰æ…°æ—¶ï¼Œæˆ‘å¸¸æƒ³å…ˆä¿æŒè·ç¦»ã€‚", dimension: 'avoidant', reverse: false },
            { id: 10, text: "æ‰¿è¯ºå’Œé•¿æœŸå…³ç³»è®©æˆ‘æœ‰è¢«æŸç¼šçš„æ„Ÿè§‰ã€‚", dimension: 'avoidant', reverse: false },
            
            // å®‰å…¨ç»´åº¦ (S1-S5) - æ­£å‘é¢˜
            { id: 11, text: "æˆ‘èƒ½å¤Ÿå¦ç„¶è¡¨è¾¾è‡ªå·±çš„éœ€æ±‚å’Œç•Œé™ã€‚", dimension: 'safe', reverse: false },
            { id: 12, text: "äº²å¯†å…³ç³»è®©æˆ‘æ›´æœ‰åŠ›é‡ï¼Œè€Œä¸æ˜¯å¤±å»è‡ªæˆ‘ã€‚", dimension: 'safe', reverse: false },
            { id: 13, text: "å½“å‘ç”Ÿå†²çªæ—¶ï¼Œæˆ‘èƒ½å…³æ³¨é—®é¢˜æœ¬èº«ï¼Œè€Œä¸æ˜¯äººèº«æ”»å‡»ã€‚", dimension: 'safe', reverse: false },
            { id: 14, text: "å½“ä¼´ä¾£æ²¡æœ‰ç«‹å³å›åº”æ—¶ï¼Œæˆ‘èƒ½è€å¿ƒç­‰å¾…ï¼Œä¸ä¼šè¿‡åº¦çŒœæµ‹ã€‚", dimension: 'safe', reverse: false },
            { id: 15, text: "æˆ‘èƒ½åœ¨äº²å¯†ä¸ç‹¬ç«‹ä¹‹é—´ä¿æŒå¾ˆå¥½çš„å¹³è¡¡ã€‚", dimension: 'safe', reverse: false }
        ];

        // ç»“æœå†…å®¹é…ç½®
        const resultConfig = {
            anxious: {
                name: "ç„¦è™‘å‹",
                badgeClass: "",
                description: "æ›´åœ¨æ„å…³ç³»çš„ç¨³å®šä¸å›åº”",
                features: [
                    "é«˜åº¦åœ¨æ„å…³ç³»çš„ç¨³å®šæ€§ï¼Œå¯¹åˆ†ç¦»å’Œå¤±å»æ•æ„Ÿ",
                    "å¯¹ä¼´ä¾£çš„å“åº”å»¶è¿Ÿä¼šæ„Ÿåˆ°ç„¦è™‘ï¼Œéœ€è¦é¢‘ç¹ç¡®è®¤",
                    "æƒ…ç»ªèµ·ä¼è¾ƒå¤§ï¼Œå†²çªåä¼šéš¾ä»¥å¹³é™",
                    "å¸Œæœ›ä¸ä¼´ä¾£ä¿æŒé«˜åº¦è¿æ¥ï¼Œä¸å¤ªé€‚åº”ç‹¬å¤„éœ€æ±‚"
                ],
                suggestions: [
                    "ç»ƒä¹ æƒ…ç»ªè‡ªæˆ‘è°ƒèŠ‚ï¼Œå­¦ä¹ æ·±å‘¼å¸å’Œæ­£å¿µæŠ€å·§",
                    "ä¸ä¼´ä¾£å»ºç«‹\"å›åº”å¥‘çº¦\"ï¼Œæ˜ç¡®æ²Ÿé€šçš„æ—¶é—´çª—å£",
                    "è®°å½•è§¦å‘æƒ…å¢ƒï¼Œé€æ­¥æ”¹å˜å¯¹\"å»¶è¿Ÿå›åº”\"çš„è§£è¯»",
                    "åŸ¹å…»è‡ªæˆ‘å®‰æŠšèƒ½åŠ›ï¼Œå‡å°‘å¯¹ä¼´ä¾£çš„è¿‡åº¦ä¾èµ–"
                ]
            },
            safe: {
                name: "å®‰å…¨å‹",
                badgeClass: "safe",
                description: "èƒ½åœ¨äº²å¯†ä¸ç‹¬ç«‹é—´ä¿æŒå¹³è¡¡",
                features: [
                    "èƒ½å¤Ÿå¦ç„¶è¡¨è¾¾è‡ªå·±çš„éœ€æ±‚å’Œç•Œé™",
                    "åœ¨äº²å¯†å…³ç³»ä¸­ä¿æŒç‹¬ç«‹ä¸ä¾èµ–çš„å¹³è¡¡",
                    "å†²çªæ—¶èƒ½å…³æ³¨é—®é¢˜æœ¬èº«ï¼Œè€Œéäººèº«æ”»å‡»",
                    "èƒ½å¤Ÿç»™äºˆä¼´ä¾£æ”¯æŒå’Œç†è§£"
                ],
                suggestions: [
                    "ç»§ç»­ä¿æŒæœ‰æ•ˆçš„æ²Ÿé€šä¹ æƒ¯å’Œæƒ…æ„Ÿè¡¨è¾¾èƒ½åŠ›",
                    "å¸®åŠ©ä¼´ä¾£ç†è§£å’Œæ”¯æŒï¼Œä¼ é€’å®‰å…¨æ„Ÿçš„ä¿¡å·",
                    "åœ¨å‹åŠ›æœŸä¸»åŠ¨è®¾å®šè¿æ¥æ—¶åˆ»ï¼Œç»´æŠ¤å…³ç³»è´¨é‡",
                    "å®šæœŸè‡ªæˆ‘åæ€ï¼Œç»´æŒå¯¹å…³ç³»åŠ¨æ€çš„æ•æ„Ÿåº¦"
                ]
            },
            avoidant: {
                name: "å›é¿å‹",
                badgeClass: "avoidant",
                description: "æ›´å€¾å‘äºä¿æŒç‹¬ç«‹å’Œè·ç¦»",
                features: [
                    "å¼ºè°ƒè‡ªä¸»å’Œç‹¬ç«‹ï¼Œä¹ æƒ¯è‡ªå·±å¤„ç†é—®é¢˜",
                    "å¯¹äº²å¯†å’Œä¾èµ–æ„Ÿåˆ°ä¸é€‚ï¼Œå€¾å‘äºä¿æŒè·ç¦»",
                    "ä¸å¤ªæ„¿æ„è¡¨è¾¾å†…å¿ƒéœ€æ±‚å’Œæƒ…ç»ª",
                    "åœ¨å…³ç³»æ„Ÿåˆ°æŸç¼šæ—¶ä¼šé€‰æ‹©ç–ç¦»"
                ],
                suggestions: [
                    "å°è¯•è®¾ç½®\"å®‰å…¨è¡¨è¾¾æ—¶æ®µ\"ï¼Œé€æ­¥ç»ƒä¹ åˆ†äº«æ„Ÿå—",
                    "å­¦ä¹ ä»æè¿°éœ€æ±‚å¼€å§‹ï¼Œè€Œéç›´æ¥ç»™å‡ºç»“è®º",
                    "è¿›è¡Œå°æ­¥ä¾èµ–ç»ƒä¹ ï¼Œä»å°çš„è¯·æ±‚å¼€å§‹å»ºç«‹ä¿¡ä»»",
                    "åœ¨å†²çªåç»™å‡º\"å¤è”æ‰¿è¯º\"ï¼Œé¿å…é•¿æœŸå†·æˆ˜"
                ]
            }
        };

        // ==================== å…¨å±€çŠ¶æ€ ====================
        let currentQuestionIndex = 0;
        let answers = {}; // { questionId: answer }

        // ==================== é¡µé¢åˆ‡æ¢ ====================
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.classList.add('active');
                window.scrollTo(0, 0);
            }
        }

        // ==================== å¼€å§‹æµ‹è¯• ====================
        function startTest() {
            const agreeCheckbox = document.getElementById('agree');
            if (!agreeCheckbox.checked) {
                alert('è¯·å…ˆé˜…è¯»å¹¶åŒæ„éšç§å£°æ˜');
                return;
            }

            // é‡ç½®çŠ¶æ€
            currentQuestionIndex = 0;
            answers = {};
            localStorage.removeItem('testAnswers');
            localStorage.removeItem('testResult');

            // åŠ è½½ç¬¬ä¸€é¢˜
            loadQuestion(0);
            showPage('test');
        }

        // ==================== åŠ è½½é¢˜ç›® ====================
        function loadQuestion(index) {
            if (index < 0 || index >= questions.length) return;

            currentQuestionIndex = index;
            const question = questions[index];
            
            // æ›´æ–°è¿›åº¦
            const progress = ((index + 1) / questions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `${index + 1} / ${questions.length}`;

            // æ›´æ–°é¢˜ç›®æ–‡æœ¬
            document.getElementById('questionText').textContent = question.text;

            // æ›´æ–°é€‰é¡¹çŠ¶æ€
            const scaleOptions = document.querySelectorAll('.scale-option');
            const savedAnswer = answers[question.id];
            
            scaleOptions.forEach((option, i) => {
                option.classList.remove('selected');
                if (savedAnswer === (i + 1)) {
                    option.classList.add('selected');
                }
            });

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.style.display = index === 0 ? 'none' : 'block';
            nextBtn.textContent = index === questions.length - 1 ? 'æäº¤' : 'ä¸‹ä¸€é¢˜';
        }

        // ==================== é€‰é¡¹ç‚¹å‡» ====================
        document.querySelectorAll('.scale-option').forEach(option => {
            option.addEventListener('click', function() {
                const value = parseInt(this.getAttribute('data-value'));
                const question = questions[currentQuestionIndex];
                
                // ä¿å­˜ç­”æ¡ˆ
                answers[question.id] = value;
                localStorage.setItem('testAnswers', JSON.stringify(answers));

                // æ›´æ–°UI
                this.parentElement.querySelectorAll('.scale-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                this.classList.add('selected');
            });
        });

        // ==================== é¢˜ç›®å¯¼èˆª ====================
        function goToPrevQuestion() {
            if (currentQuestionIndex > 0) {
                loadQuestion(currentQuestionIndex - 1);
            }
        }

        function goToNextQuestion() {
            const question = questions[currentQuestionIndex];
            
            // æ£€æŸ¥æ˜¯å¦å·²å›ç­”
            if (!answers[question.id]) {
                alert('è¯·å…ˆé€‰æ‹©ä½ çš„ç­”æ¡ˆ');
                return;
            }

            // å¦‚æœæ˜¯æœ€åä¸€é¢˜ï¼Œæäº¤
            if (currentQuestionIndex === questions.length - 1) {
                submitTest();
            } else {
                loadQuestion(currentQuestionIndex + 1);
            }
        }

        // ==================== æäº¤æµ‹è¯• ====================
        function submitTest() {
            // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰é¢˜ç›®éƒ½å·²å›ç­”
            const unanswered = questions.filter(q => !answers[q.id]);
            if (unanswered.length > 0) {
                alert(`è¿˜æœ‰ ${unanswered.length} é“é¢˜æœªå›ç­”ï¼Œè¯·å®Œæˆæ‰€æœ‰é¢˜ç›®`);
                return;
            }

            // ä¿å­˜ç­”æ¡ˆ
            localStorage.setItem('testAnswers', JSON.stringify(answers));

            // æ˜¾ç¤ºåŠ è½½é¡µ
            showPage('loading');

            // å»¶è¿Ÿè®¡ç®—ï¼Œå¢åŠ çœŸå®æ„Ÿ
            setTimeout(() => {
                const result = calculateResult();
                localStorage.setItem('testResult', JSON.stringify(result));
                displayResult(result);
            }, 2000);
        }

        // ==================== è®¡ç®—ç»“æœ ====================
        function calculateResult() {
            let anxiousScore = 0;
            let avoidantScore = 0;
            let safeScore = 0;

            // è®¡ç®—å„ç»´åº¦å¾—åˆ†
            questions.forEach(q => {
                const answer = answers[q.id];
                if (!answer) return;

                if (q.dimension === 'anxious') {
                    anxiousScore += answer;
                } else if (q.dimension === 'avoidant') {
                    avoidantScore += answer;
                } else if (q.dimension === 'safe') {
                    safeScore += answer;
                }
            });

            // æ ‡å‡†åŒ–åˆ°0-100åˆ†
            // æ¯ä¸ªç»´åº¦5é¢˜ï¼Œæ¯é¢˜1-5åˆ†ï¼Œæ€»åˆ†5-25åˆ†
            const normalizeScore = (score) => {
                return Math.round(((score - 5) / (25 - 5)) * 100);
            };

            const anxiousNormalized = normalizeScore(anxiousScore);
            const avoidantNormalized = normalizeScore(avoidantScore);
            const safeNormalized = normalizeScore(safeScore);

            // åˆ¤å®šç±»å‹
            // å¦‚æœå®‰å…¨å‹å¾—åˆ†â‰¥70ä¸”ç„¦è™‘å’Œå›é¿éƒ½è¾ƒä½ï¼Œåˆ™ä¸ºå®‰å…¨å‹
            // å¦åˆ™å–ç„¦è™‘å’Œå›é¿ä¸­è¾ƒé«˜è€…
            let type = 'anxious';
            
            if (safeNormalized >= 70 && anxiousNormalized < 50 && avoidantNormalized < 50) {
                type = 'safe';
            } else if (avoidantNormalized > anxiousNormalized) {
                type = 'avoidant';
            } else {
                type = 'anxious';
            }

            return {
                type: type,
                scores: {
                    anxious: anxiousNormalized,
                    avoidant: avoidantNormalized,
                    safe: safeNormalized
                },
                rawScores: {
                    anxious: anxiousScore,
                    avoidant: avoidantScore,
                    safe: safeScore
                }
            };
        }

        // ==================== æ˜¾ç¤ºç»“æœ ====================
        function displayResult(result) {
            const config = resultConfig[result.type];
            
            // æ›´æ–°å¾½ç« 
            const badge = document.getElementById('resultBadge');
            badge.textContent = config.name;
            badge.className = 'result-badge ' + config.badgeClass;

            // æ›´æ–°å›¾è¡¨
            const chartHtml = `
                <div class="chart-bar">
                    <div class="chart-label">
                        <span>ç„¦è™‘ç»´åº¦</span>
                        <span>${result.scores.anxious}åˆ†</span>
                    </div>
                    <div class="chart-fill">
                        <div class="chart-value anxious" style="width: ${result.scores.anxious}%;"></div>
                    </div>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">
                        <span>å›é¿ç»´åº¦</span>
                        <span>${result.scores.avoidant}åˆ†</span>
                    </div>
                    <div class="chart-fill">
                        <div class="chart-value avoidant" style="width: ${result.scores.avoidant}%;"></div>
                    </div>
                </div>
                <div class="chart-bar">
                    <div class="chart-label">
                        <span>å®‰å…¨ç»´åº¦</span>
                        <span>${result.scores.safe}åˆ†</span>
                    </div>
                    <div class="chart-fill">
                        <div class="chart-value safe" style="width: ${result.scores.safe}%;"></div>
                    </div>
                </div>
            `;
            document.getElementById('resultChart').innerHTML = chartHtml;

            // æ›´æ–°ç‰¹ç‚¹
            const featureList = document.getElementById('featureList');
            featureList.innerHTML = config.features.map(f => `<li>${f}</li>`).join('');

            // æ›´æ–°å»ºè®®
            const suggestionList = document.getElementById('suggestionList');
            suggestionList.innerHTML = config.suggestions.map(s => `<li>${s}</li>`).join('');

            // æ˜¾ç¤ºç»“æœé¡µ
            showPage('result');
        }

        // ==================== åˆ†äº«ç»“æœ ====================
        function shareResult() {
            const resultData = localStorage.getItem('testResult');
            if (!resultData) {
                alert('æ²¡æœ‰å¯åˆ†äº«çš„ç»“æœ');
                return;
            }

            const result = JSON.parse(resultData);
            const config = resultConfig[result.type];

            // æ›´æ–°åˆ†äº«é¡µå†…å®¹
            document.getElementById('shareTitle').textContent = `æˆ‘æ˜¯ã€Œ${config.name}ã€`;
            document.getElementById('shareSubtitle').textContent = config.description;

            showPage('share');
        }

        // ==================== å¤åˆ¶é“¾æ¥ ====================
        function copyLink() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            }).catch(() => {
                // é™çº§æ–¹æ¡ˆ
                const textarea = document.createElement('textarea');
                textarea.value = url;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                alert('é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
            });
        }

        // ==================== é‡ç½®æµ‹è¯• ====================
        function resetTest() {
            if (confirm('ç¡®å®šè¦é‡æ–°å¼€å§‹æµ‹è¯•å—ï¼Ÿå½“å‰ç»“æœå°†è¢«æ¸…é™¤ã€‚')) {
                // æ¸…é™¤æ‰€æœ‰æ•°æ®
                answers = {};
                currentQuestionIndex = 0;
                localStorage.removeItem('testAnswers');
                localStorage.removeItem('testResult');
                
                // é‡ç½®å¤é€‰æ¡†
                const agreeCheckbox = document.getElementById('agree');
                if (agreeCheckbox) {
                    agreeCheckbox.checked = false;
                }
                
                // è¿”å›é¦–é¡µ
                showPage('home');
            }
        }

        // ==================== æ¢å¤æµ‹è¯•è¿›åº¦ ====================
        function restoreTestProgress() {
            const savedAnswers = localStorage.getItem('testAnswers');
            if (savedAnswers) {
                answers = JSON.parse(savedAnswers);
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆ
                const allAnswered = questions.every(q => answers[q.id]);
                if (allAnswered) {
                    // å¦‚æœæœ‰ä¿å­˜çš„ç»“æœï¼Œç›´æ¥æ˜¾ç¤º
                    const savedResult = localStorage.getItem('testResult');
                    if (savedResult) {
                        const result = JSON.parse(savedResult);
                        displayResult(result);
                        return;
                    }
                } else {
                    // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªå›ç­”çš„é¢˜ç›®
                    const firstUnansweredIndex = questions.findIndex(q => !answers[q.id]);
                    if (firstUnansweredIndex >= 0) {
                        loadQuestion(firstUnansweredIndex);
                        showPage('test');
                        return;
                    }
                }
            }
        }

        // ==================== åˆå§‹åŒ– ====================
        document.addEventListener('DOMContentLoaded', function() {
            // å°è¯•æ¢å¤æµ‹è¯•è¿›åº¦
            restoreTestProgress();

            // ä¸ºå¯¼èˆªé“¾æ¥æ›´æ–°
            document.querySelectorAll('.prototype-nav a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const onclick = this.getAttribute('onclick');
                    if (onclick) {
                        eval(onclick);
                    }
                });
            });
        });
    </script>
</body>
</html>

